<!-- This file was automatically generated from Markdown or JSON source files.
     DO NOT edit this file directly but look for the according source file! --><!DOCTYPE html><html><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"><link href="/static/css/docs.css" rel="stylesheet"><title>Emojicode Documentation &middot; The Cookie Monster Game</title></head><body><nav class="menu" role="navigation"><a href="/" class="menu-logo">Emojicode</a><div class="menu-right"><a href="&#x2F;docs&#x2F;" class="active">Documentation</a> <a href="https://github.com/emojicode">GitHub</a></div></nav><header class="docs-header"><a href="&#x2F;docs&#x2F;" class="docs-header-title">Emojicode Documentation <span class="docs-header-version">0.5</span></a><div class="docs-header-right"><a href="&#x2F;docs&#x2F;guides" class="active">Guides</a> <a href="&#x2F;docs&#x2F;reference">Language Reference</a> <a href="&#x2F;docs&#x2F;packages">Package Index</a></div></header><div class="content"><div class="toc-wrapper"><div class="toc"><h2>Guides</h2><ol data-gumshoe><li><a href="install.html" class="chapter-link">Installing Emojicode</a></li><li><a href="compile-and-run.html" class="chapter-link">Compile and Run Your First Program</a></li><li><a href="input-methods.html" class="chapter-link">Input methods</a></li><li><a href="allegro.html" class="chapter-link current">The Cookie Monster Game</a><ul><li><a href="#creating-an-app" class="section-link">Creating an app</a></li><li><a href="#power-to-the-classes" class="section-link">Power to the classes</a></li><li><a href="#check-out-that-event" class="section-link">Check out that event</a></li><li><a href="#me-want-eat-cookies" class="section-link">Me want eat cookies</a></li><li><a href="#scores" class="section-link">Scores</a></li><li><a href="#the-acoustic-experience" class="section-link">The acoustic experience</a></li></ul></li><li><a href="packageAPI.html" class="chapter-link">The Package API</a></li></ol></div></div><h1 id="the-cookie-monster-game">The Cookie Monster Game</h1><p>This chapter introduces you to the basics of writing a simple game with the allegro package, which ships with Emojicode. This guide assumes that you have have a basic knowledge of object-oriented programming and have read <a href="compile-and-run.html">Compile and Run Your First Program</a>.</p><h2 id="creating-an-app">Creating an app</h2><p>First of all we need to important the allegro package:</p><pre><code>ğŸ“¦ allegro ğŸ”´
</code></pre><p>This makes all types from the <code>allegro</code> package available in the namespace ğŸ”´ (of our package, which by definition is <code>_</code>), i.e. we can access all classes provided by the allegro package from our application.</p><p>Next we need to startup the application, so weâ€™ll create the ğŸ function:</p><pre><code>ğŸ ğŸ‡
  ğŸ©ğŸ™‹ğŸ” ğŸ‡ app ğŸ”

  ğŸ‰
ğŸ‰
</code></pre><p>As youâ€™ve seen, thereâ€™s already some code in the ğŸ function. <code>ğŸ©ğŸ™‹ğŸ”</code> is a type method call. This means we call a method (ğŸ™‹) directly on a type (ğŸ”). Thereâ€™s one more thing to notice: the following code block. This code block creates a closure that takes an argument <code>app</code> of type <code>ğŸ”</code>. Closures are a kind of function that capture the context in which they were created, i.e. the variables and the object on which a method was called.</p><p>So what is this good for? The ğŸ™‹ type method of the ğŸ” class, which is provided by the allegro package, is really important as it initiates the application in such a way that it can display windows, receive events and play sounds. This method normally doesnâ€™t return but instead calls the given callable in an appropriate way and passes it an instance of ğŸ” that represents the created application. Weâ€™ll use it to draw in a moment.</p><p>To recap: Call this class method, provide it with a callable and setup the application from there.</p><p>Weâ€™ll do so by creating a ğŸ“º instance. A ğŸ“º instance (say <em>display</em>) is responsible for displaying graphics on the computers screen. On many operating systems a ğŸ“º will be represented by a window.</p><p>ğŸ“º provides a single initializer:</p><pre class="declaration">
ğŸ”“ ğŸˆ ğŸ†• width <a href="../packages/s/1f682.html">ğŸš‚</a> height <a href="../packages/s/1f682.html">ğŸš‚</a> </pre><p>Our code to get a display is therefore:</p><pre><code>ğŸ¦ display ğŸ”·ğŸ“ºğŸ†• 1000 1000
</code></pre><p>Now that weâ€™ve a ğŸ“º instance we can configure it. Weâ€™ll set its title:</p><pre><code>ğŸ· display ğŸ”¤Cookie Monster GameğŸ”¤
</code></pre><p>Thatâ€™s good moment to test if things are working so far. If we, however, compiled and ran this program know we wouldnâ€™t see much due to the fact that program would create a display and immediately terminate. So weâ€™ll tell it to wait for a few seconds after the display was created:</p><pre><code>ğŸ©â²ğŸ’ˆ 10_000_000
</code></pre><p>Donâ€™t worry, â² takes the number of microseconds to wait. And 10,000,000 microseconds are only 10 seconds. Save the file, compile it and run it. You should see something similar to this:</p><p><img src="/static/img/cookiemonster1.png" width="300"></p><p>Not very impressive, is it? Letâ€™s do something more interesting and draw some cookies onto the screen. <a href="https://github.com/emojicode/cookie-monster
-game/raw/master/cookie.png">Download</a> a cookie image from here, copy it into the directory in which your program is stored.</p><p>In order to display the image on the screen, it must be loaded as a bitmap first. Fortunately thereâ€™s a ğŸ–¼ - thatâ€™s the bitmap class â€“ initializer that can exactly do that. Itâ€™s called ğŸ“„ takes a path to the image and is declared like this:</p><p>You certainly noted the <code>ğŸš¨ğŸŒ©</code>, which indicates that the initializer might return an error instead of a bitmap object. We must deal with this possibly arising error and do so by simply assuming that there will never be an error:</p><pre><code>ğŸ¦ cookieBmp ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie.pngğŸ”¤
</code></pre><p>The <code>ğŸš‡</code> tells the compiler that we are sure there will never be an error. (If in reality there is an error the program will simply crash. Not very elegant.) For brevity, let&#39;s leave it at that. But make sure that you properly handle errors in a real application.</p><p>Now that weâ€™ve the bitmap, weâ€™ll draw it onto the screen:</p><pre><code>ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
ğŸ“¼ app cookieBmp 500 500
ğŸ¦ app
</code></pre><p>Make sure you place this code <em>before</em> <code>ğŸ©â²ğŸ’ˆ 10_000_000</code> or you wonâ€™t see anything. If everything goes well, you should see a tasty cookie in front of a white background, neatly centered in the display.</p><p>Wondering whatâ€™s going on â€™cause thatâ€™s a bunch of method calls? Well, these are all important drawing functions. And they all have one thing in common: They are methods called on our <code>app</code> and draw to the current drawing target. By creating a display weâ€™ve created a drawing target which was then also set as the current drawing target.</p><p>The ğŸš¿ type method fills the entire drawing target with the given color which was here created by providing RGBA values. The ğŸ“¼ method then draws a bitmap at the specified coordinates. Last but not least the ğŸ¦ makes all changes visible: Everything you draw is drawn in a backbuffer first and gets visible once you call the ğŸ¦ method.</p><p>Letâ€™s extend our code to also show the cookie monster (<a href="https://github.com/emojicode/cookie-monster-game/raw/master/cookie_monster.png">download</a> here) and an additional cookie:</p><pre><code>ğŸ“¦ allegro ğŸ”´

ğŸ ğŸ‡
  ğŸ©ğŸ™‹ğŸ” ğŸ‡ app ğŸ”
    ğŸ¦ display ğŸ”·ğŸ“ºğŸ†• 1000 1000
    ğŸ· display ğŸ”¤Cookie Monster GameğŸ”¤

    ğŸ¦ cookieBmp ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie.pngğŸ”¤
    ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
    ğŸ“¼ app cookieBmp 500 500
    ğŸ“¼ app cookieBmp 400 400 ğŸ‘´ The Cookie Monster can never get enough cookies

    ğŸ¦ monster ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie_monster.pngğŸ”¤
    ğŸ“¼ app monster 200 200

    ğŸ¦ app

    ğŸ©â²ğŸ’ˆ 10_000_000
  ğŸ‰
ğŸ‰
</code></pre><p>Running this should result in something similar to this:</p><p><img src="/static/img/cookiemonster2.png" width="300"></p><h2 id="power-to-the-classes">Power to the classes</h2><p>Everything works, but frankly, itâ€™s not really future-proof code. Emojicode is an object-oriented language, so everything would be much better with classes.</p><p>First of all, let us create a ğŸ¦ class that represents the Cookie Monster:</p><pre><code>ğŸ‡ ğŸ¦ ğŸ‡
  ğŸ° x ğŸš€
  ğŸ° y ğŸš€
  ğŸ° monster ğŸ–¼

  ğŸˆ ğŸ†• ğŸ‡
    ğŸ® x 500
    ğŸ® y 500
    ğŸ® monster ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie_monster.pngğŸ”¤
  ğŸ‰

  ğŸ– ğŸ–Œ app ğŸ” ğŸ‡
    ğŸ“¼ app monster x y
  ğŸ‰
ğŸ‰
</code></pre><p>This is a very basic class. It has three instance variables: <code>x</code> and <code>y</code> that hold the position of the Cookie Monster and <code>bitmap</code> that holds the bitmap. The initializer sets the initial position of the monster to (500, 500) and loads the bitmap. Also, the cookie monster has a method draw itself: ğŸ–Œ.</p><p>Next, hereâ€™s a class for cookies:</p><pre><code>ğŸ‡ ğŸª ğŸ‡
  ğŸ° cookie ğŸ–¼
  ğŸ° x ğŸš€
  ğŸ° y ğŸš€

  ğŸˆ ğŸ†• ğŸ¼ x ğŸš€ ğŸ¼ y ğŸš€ ğŸ¼ cookie ğŸ–¼  ğŸ‡ğŸ‰

  ğŸ– ğŸ–Œ app ğŸ” ğŸ‡
    ğŸ“¼ app cookie x y
  ğŸ‰
ğŸ‰
</code></pre><p>Thereâ€™s a difference to the ğŸ¦ class: ğŸªğŸ†• takes a bitmap argument and coordinates. The reason for this is that we want to create multiple cookies later on and they should, of course, share the same bitmap and have different positions. For this reason weâ€™ll instantiate the bitmap once and pass it to all ğŸª instances.</p><p>So letâ€™s update the ğŸ function to use the new classes:</p><pre><code>ğŸ ğŸ‡
  ğŸ©ğŸ™‹ğŸ” ğŸ‡ app ğŸ”
    ğŸ¦ display ğŸ”·ğŸ“ºğŸ†• 1000 1000
    ğŸ· display ğŸ”¤Cookie Monster GameğŸ”¤

    ğŸ¦ cookieBmp ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie.pngğŸ”¤  ğŸ‘´ Load the cookie bitmap

    ğŸ¦ cookies ğŸ”·ğŸ¨ğŸšğŸªğŸ¸
    ğŸ¦ prng ğŸ”·ğŸ°ğŸ†•
    ğŸ”‚ i â© 0 10 ğŸ‡  ğŸ‘´ Create 10 randomly placed cookies
      ğŸ» cookies ğŸ”·ğŸªğŸ†• ğŸš€ğŸš‚ prng 50 900 ğŸš€ğŸš‚ prng 50 900 cookieBmp
    ğŸ‰

    ğŸ¦ monster ğŸ”·ğŸ¦ğŸ†• ğŸ‘´ Instantiate a monster

    ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
    ğŸ–Œ monster app ğŸ‘´ Draw the monster
    ğŸ”‚ cookie cookies ğŸ‡ ğŸ‘´ Draw all cookies
      ğŸ–Œ cookie app
    ğŸ‰

    ğŸ¦ app

    ğŸ©â²ğŸ’ˆ 10_000_000
  ğŸ‰
ğŸ‰
</code></pre><p>As you can see we didnâ€™t just replace the drawing calls but also introduced a ğŸ¨ <code>cookies</code> which stores ten randomly placed cookie objects. <code>ğŸ”·ğŸ°ğŸ†•</code> creates a pseudo-random number generator, an object we can ask for random numbers. We use it to get integers between 50 and 900, which are then converted into ğŸš€s with ğŸš‚â€™s ğŸš€ method. Later on this ğŸ¨ is iterated and ğŸ–Œ is called on each cookie.</p><p>If you run the program youâ€™ll see something similar to this:</p><p><img src="/static/img/cookiemonster3.png" width="300"></p><h2 id="check-out-that-event">Check out that event</h2><p>Everything is working fine so far but itâ€™s not a game yet. We need to grant the user a bit of control over the game. In order to achieve this we need to instantiate an <em>event queue</em> which is constantly queried for events.</p><p>First, create the event queue:</p><pre><code>ğŸ¦ queue ğŸ”·ğŸ—ƒğŸ†•
âŒ¨ï¸ queue
</code></pre><p>The code above creates an event queue and registers the keyboard as an event source for that queue. Next, a loop which constantly queries the event queue for an event. Such a loop is often referred to as <em>the run loop</em>:</p><pre><code>ğŸ” ğŸ‘ ğŸ‡
  ğŸ¦ event â³ queue

ğŸ‰
</code></pre><p>The â³ method of â³ waits for an event to occur and returns it. So the next thing is to classify the event and handle it appropriately. Since we want the Cookie Monster to be movable with the arrow keys we need to check for a key-down event and then check in which direction that Cookie Monster should move.</p><pre><code>ğŸŠğŸ¦ keyboardEvent ğŸ”² event ğŸ“© ğŸ‡
  ğŸŠ ğŸ˜›ğŸ“Ÿ keyboardEvent 84 ğŸ‡
    â¬†ï¸ monster
  ğŸ‰
  ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 85 ğŸ‡
    â¬‡ï¸ monster
  ğŸ‰
  ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 82 ğŸ‡
    â¬…ï¸ monster
  ğŸ‰
  ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 83 ğŸ‡
    â¡ï¸ monster
  ğŸ‰
ğŸ‰
</code></pre><p>Letâ€™s walk through this code: The first line tries to cast <code>event</code> to <code>ğŸ“©</code>, a key press event. Then we determine which keycode was associated with this event. 84 stands for arrow up, 85 for arrow down, 82 for arrow left and 83 for arrow right. According to these direction, methods get called on <code>monster</code>. And yes, we have yet to implement them in ğŸ¦:</p><pre><code>ğŸ– â¬‡ï¸ ğŸ‡
  ğŸ® y â• y 10
ğŸ‰

ğŸ– â¬†ï¸ ğŸ‡
  ğŸ® y â– y 10
ğŸ‰

ğŸ– â¬…ï¸ ğŸ‡
  ğŸ® x â– x 10
ğŸ‰

ğŸ– â¡ï¸ ğŸ‡
  ğŸ® x â• x 10
ğŸ‰
</code></pre><p>This methods obviously just change the coordinates to move the monster accordingly. So thereâ€™s just one step left, before you can control the Cookie Monster with the arrow keys. We need to redraw the game in the run loop, i.e. we need to draw everything all over again to make the changes to the Cookie Monster visible:</p><pre><code>ğŸ ğŸ‡
  ğŸ©ğŸ™‹ğŸ” ğŸ‡ app ğŸ”
    ğŸ¦ display ğŸ”·ğŸ“ºğŸ†• 1000 1000
    ğŸ· display ğŸ”¤Cookie Monster GameğŸ”¤

    ğŸ¦ cookieBmp ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie.pngğŸ”¤

    ğŸ¦ cookies ğŸ”·ğŸ¨ğŸšğŸªğŸ¸
    ğŸ¦ prng ğŸ”·ğŸ° ğŸ†•
    ğŸ”‚ i â© 0 10 ğŸ‡
      ğŸ» cookies ğŸ”·ğŸªğŸ†• ğŸš€ğŸš‚ prng 50 900 ğŸš€ğŸš‚ prng 50 900 cookieBmp
    ğŸ‰

    ğŸ¦ monster ğŸ”·ğŸ¦ğŸ†•

    ğŸ¦ queue ğŸ”·ğŸ—ƒğŸ†•
    âŒ¨ï¸ queue
    ğŸ” ğŸ‘ ğŸ‡
      ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
      ğŸ–Œ monster app

      ğŸ”‚ cookie cookies ğŸ‡
        ğŸ–Œ cookie app
      ğŸ‰
      ğŸ¦ app

      ğŸ¦ event â³ queue

      ğŸŠğŸ¦ keyboardEvent ğŸ”² event ğŸ“© ğŸ‡
        ğŸŠ ğŸ˜›ğŸ“Ÿ keyboardEvent 84 ğŸ‡
          â¬†ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 85 ğŸ‡
          â¬‡ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 82 ğŸ‡
          â¬…ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 83 ğŸ‡
          â¡ï¸ monster
        ğŸ‰
      ğŸ‰
    ğŸ‰
  ğŸ‰
ğŸ‰
</code></pre><p>The ğŸ function should now look like above. Note, that weâ€™ve also dropped the delay at the end of the initializer â€“ itâ€™s no longer needed.</p><p>You can now control the monster with your keyboard!</p><h2 id="me-want-eat-cookies">Me want eat cookies</h2><p>So far, so good. But actually the Cookie Monster wants to the eat the cookies and not just to walk underneath them. In order to achieve this, we need to add two methods to the ğŸ¦ class that return the current coordinates of the mouth of Cookie Monster:</p><pre><code>ğŸ– ğŸ‘‰ï¸ â¡ï¸ ğŸš€ ğŸ‡
  ğŸ â• x 60
ğŸ‰

ğŸ– ğŸ‘‡ â¡ï¸ ğŸš€ ğŸ‡
  ğŸ â• y 70
ğŸ‰
</code></pre><p>Thatâ€™s really nothing special. Since the coordinates stored in the <code>x</code> and <code>y</code> variables point to the top left of the cookie monster, 60 and 70 get added so that the returned coordinates point to the center of the mouth.</p><p>Weâ€™ll now replace ğŸªâ€™s ğŸ–Œ method by a much more advanced method:</p><pre><code>ğŸ– ğŸ–Š app ğŸ” monsterX ğŸš€ monsterY ğŸš€ â¡ï¸ ğŸ‘Œ ğŸ‡
  ğŸŠ ğŸŠğŸŠâ¡ï¸ monsterX x â¬…ï¸ monsterX â• x 50 ğŸŠâ¡ï¸ monsterY y â¬…ï¸ monsterY â• y 50 ğŸ‡
    ğŸ ğŸ‘
  ğŸ‰
  ğŸ“¼ app cookie x y
  ğŸ ğŸ‘
ğŸ‰
</code></pre><p>Evidently, this method takes two arguments which are the location of the Cookie Monster, or more specifically, its mouth. The next line might be a bit more difficult to understand. It compares whether the coordinate of the Cookie Monsterâ€˜s mouth are within the cookie. If thatâ€˜s the case the method immediately returns ğŸ‘, otherwise the cookie is drawn as usual and ğŸ‘ is returned.</p><p>Clearly, we now also need to update our loop to draw cookies:</p><pre><code>ğŸ¦ iterator ğŸ”·ğŸŒ±ğŸšğŸªğŸ†• cookies
ğŸ”‚ cookie iterator ğŸ‡
ğŸŠ ğŸ–Š ğŸºcookie app ğŸ‘‰ï¸ monster ğŸ‘‡ monster ğŸ‡
  ğŸš¯ iterator
ğŸ‰
</code></pre><p>The code above is really straightforward. We create an ğŸŒ± iterator instance for <code>cookies</code>, to which a reference is then stored in <code>iterator</code>. Then this iterator is used with the ğŸ”‚ loop to get each cookie. ğŸ–Š is called on each cookie and the coordinates of the monster, which we can get from the new ğŸ‘‰ï¸ğŸ‘‡ methods, are passed. If the ğŸ–Š method returns true, this means the Cookie Monsters mouth touched the cookie, the ğŸš¯ method is called on the iterator, which removes the current element from the array. (Thatâ€™s a special capability of ğŸŒ± and the reason why we created it explicitly.)</p><p>Try running the game now! The Cookie Monster will be happy to eat the cookies.</p><h2 id="scores">Scores</h2><p>Cool game, isnâ€™t it? But it would be nice if there was a counter showing how many cookies there are still left, wouldnâ€™t it? And probably a special screen when the game is finished?</p><p>To recap: We want to display some text. And therefore we need a font. <a href="https://github.com/emojicode/cookie-
monster-game/raw/master/Monoton-Regular.ttf">Download a cool font here</a> and put it into the same directory as <code>cookie.emojic</code>.</p><p>Now we can load that font (and you should do this before the run loop):</p><pre><code>ğŸ¦ font ğŸš‡ğŸ”·ğŸ•‰ğŸ“„ ğŸ”¤Monoton-Regular.ttfğŸ”¤ 63
</code></pre><p>The same disclaimer applies again: Donâ€™t skip error checking although we do it here for shortness. <code>ğŸ”·ğŸ•‰ğŸ“„</code> instantiates a new instance of ğŸ•‰, which represents the font. The two arguments are the path to the font and the size of the font.</p><p>In the run loop weâ€™ll draw the number of cookies left:</p><pre><code>ğŸ”¡ app font ğŸ”¡ ğŸ” cookies 10 990 10 ğŸ”·âš–â¡ï¸ ğŸ”·ğŸ¨ğŸ†• 0 0 0 255
</code></pre><p>Place this code before <code>ğŸ¦ app</code>. <code>ğŸ”¡</code> draws a text using the given font. It is define like this:</p><pre class="declaration">ğŸ”“ ğŸ– ğŸ”¡ font <a href="../packages/allegro/1f549.html">ğŸ•‰</a> text <a href="../packages/s/1f521.html">ğŸ”¡</a> x <a href="../packages/s/1f680.html">ğŸš€</a> y <a href="../packages/s/1f680.html">ğŸš€</a> align <a href="../packages/allegro/2696.html">âš–</a> color <a href="../packages/allegro/1f3a8.html">ğŸ¨</a> â¡ï¸ âœ¨</pre><p>Quite a lot of arguments. Most things should be pretty clear. <code>align</code> is a âš–, an enum, which specifies how the text should be aligned. In our example we used ğŸ”·âš–â¡ï¸ to align the text to the right, i.e. the top right corner of the text will always be at the coordinates passed to <code>x</code> and <code>y</code>.</p><p>If you try the game now youâ€™ll see a counter in the top right showing how many cookies are left.</p><p>As mentioned before, a screen at the end of the game would be nice:</p><pre><code>ğŸŠ ğŸ˜› ğŸ” cookies 0 ğŸ‡
  ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 4 115 187 255
  ğŸ”¡ app font ğŸ”¤Well done!ğŸ”¤ 500 500 ğŸ”·âš–â†” ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
  ğŸ¦ app

  ğŸ” ğŸ‘ ğŸ‡
    ğŸ¦ event â³ queue
    ğŸŠğŸ¦ keyboardEvent ğŸ”² event ğŸ“© ğŸ‡
      ğŸŠ ğŸ¦ key ğŸ”£ keyboardEvent ğŸ‡
        ğŸŠ ğŸ˜› key ğŸ”Ÿq ğŸ‡
          ğŸ âš¡ï¸
        ğŸ‰
      ğŸ‰
    ğŸ‰
  ğŸ‰
  ğŸ âš¡ï¸
ğŸ‰
</code></pre><p>Obviously, this code should be placed after the ğŸ”‚ loop for <code>cookies</code> and before querying for new events. Once all cookies have been collected, youâ€™ll see the following screen:</p><p><img src="/static/img/cookiemonster4.png" width="300"></p><h2 id="the-acoustic-experience">The acoustic experience</h2><p>Our game is missing something really essential: Sound. So go, and grab <a href="https://github.com/emojicode/cookie-
monster-game/raw/master/sound.wav">this nice sound</a> and <a href="https://github.com/
emojicode/cookie-monster-game/raw/master/sound_end.wav">this sound</a> and put them aside <code>cookie.emojic</code>.</p><p>The <code>sound.wav</code> should be played whenever the Cookie Monster is eating a cookie. Weâ€™ll of course load the file only once and that of course before the run loop.</p><pre><code>ğŸ¦ sample ğŸš‡ğŸ”·ğŸ¶ğŸ“„ ğŸ”¤sound.wavğŸ”¤
</code></pre><p>Then letâ€™s add some code to play the sound after a cookie was eaten:</p><pre><code>ğŸ”‚ cookie iterator ğŸ‡
  ğŸŠ ğŸ–Š ğŸºcookie app ğŸ‘‰ï¸ monster ğŸ‘‡ monster ğŸ‡
    ğŸš¯ iterator
    ğŸŠ â–¶ï¸ ğŸ” cookies 0 ğŸ‡
      ğŸ sample 1 0 1
    ğŸ‰
  ğŸ‰
ğŸ‰
</code></pre><p>This code might need some explanation. We added a ğŸŠ to check ensure we donâ€™t play the sound for the last cookie. <code>ğŸ sample 1 0 1</code> plays the loaded sample at full volume, no shift towards the left or right and normal speed.</p><p>When presenting the â€œWell done!â€ screen <code>sound_end.wav</code> should be played so weâ€™ll add the following code:</p><pre><code>ğŸ¦ endSample ğŸš‡ğŸ”·ğŸ¶ğŸ“„ ğŸ”¤sound_end.wavğŸ”¤
ğŸ endSample 1 0 1
</code></pre><p>The whole program should now look like this:</p><pre><code>ğŸ“¦ allegro ğŸ”´

ğŸ‡ ğŸ¦ ğŸ‡
  ğŸ° x ğŸš€
  ğŸ° y ğŸš€
  ğŸ° monster ğŸ–¼

  ğŸˆ ğŸ†• ğŸ‡
    ğŸ® x 500
    ğŸ® y 500
    ğŸ® monster ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie_monster.pngğŸ”¤
  ğŸ‰

  ğŸ– ğŸ–Œ app ğŸ” ğŸ‡
    ğŸ“¼ app monster x y
  ğŸ‰

  ğŸ– â¬‡ï¸ ğŸ‡
    ğŸ® y â• y 10
  ğŸ‰

  ğŸ– â¬†ï¸ ğŸ‡
    ğŸ® y â– y 10
  ğŸ‰

  ğŸ– â¬…ï¸ ğŸ‡
    ğŸ® x â– x 10
  ğŸ‰

  ğŸ– â¡ï¸ ğŸ‡
    ğŸ® x â• x 10
  ğŸ‰

  ğŸ– ğŸ‘‰ï¸ â¡ï¸ ğŸš€ ğŸ‡
    ğŸ â• x 60
  ğŸ‰

  ğŸ– ğŸ‘‡ â¡ï¸ ğŸš€ ğŸ‡
    ğŸ â• y 70
  ğŸ‰
ğŸ‰


ğŸ‡ ğŸª ğŸ‡
  ğŸ° cookie ğŸ–¼
  ğŸ° x ğŸš€
  ğŸ° y ğŸš€

  ğŸˆ ğŸ†• ğŸ¼ x ğŸš€ ğŸ¼ y ğŸš€ ğŸ¼ cookie ğŸ–¼  ğŸ‡ğŸ‰

  ğŸ– ğŸ–Š app ğŸ” monsterX ğŸš€ monsterY ğŸš€ â¡ï¸ ğŸ‘Œ ğŸ‡
    ğŸŠ ğŸŠğŸŠâ¡ï¸ monsterX x â¬…ï¸ monsterX â• x 50 ğŸŠâ¡ï¸ monsterY y â¬…ï¸ monsterY â• y 50 ğŸ‡
      ğŸ ğŸ‘
    ğŸ‰
    ğŸ“¼ app cookie x y
    ğŸ ğŸ‘
  ğŸ‰
ğŸ‰

ğŸ ğŸ‡
  ğŸ©ğŸ™‹ğŸ” ğŸ‡ app ğŸ”
    ğŸ¦ display ğŸ”·ğŸ“ºğŸ†• 1000 1000
    ğŸ· display ğŸ”¤Cookie Monster GameğŸ”¤

    ğŸ¦ cookieBmp ğŸš‡ğŸ”·ğŸ–¼ğŸ“„ ğŸ”¤cookie.pngğŸ”¤

    ğŸ¦ cookies ğŸ”·ğŸ¨ğŸšğŸªğŸ¸
    ğŸ¦ prng ğŸ”·ğŸ° ğŸ†•
    ğŸ”‚ i â© 0 10 ğŸ‡
      ğŸ» cookies ğŸ”·ğŸªğŸ†• ğŸš€ğŸš‚ prng 50 900 ğŸš€ğŸš‚ prng 50 900 cookieBmp
    ğŸ‰

    ğŸ¦ sample ğŸš‡ğŸ”·ğŸ¶ğŸ“„ ğŸ”¤sound.wavğŸ”¤

    ğŸ¦ font ğŸš‡ğŸ”·ğŸ•‰ğŸ“„ ğŸ”¤Monoton-Regular.ttfğŸ”¤ 63
    ğŸ¦ monster ğŸ”·ğŸ¦ğŸ†•

    ğŸ¦ queue ğŸ”·ğŸ—ƒğŸ†•
    âŒ¨ï¸ queue
    ğŸ” ğŸ‘ ğŸ‡
      ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
      ğŸ–Œ monster app

      ğŸ¦ iterator ğŸ”·ğŸŒ±ğŸšğŸªğŸ†• cookies
      ğŸ”‚ cookie iterator ğŸ‡
        ğŸŠ ğŸ–Š ğŸºcookie app ğŸ‘‰ï¸ monster ğŸ‘‡ monster ğŸ‡
          ğŸš¯ iterator
          ğŸŠ â–¶ï¸ ğŸ” cookies 0 ğŸ‡
            ğŸ sample 1 0 1
          ğŸ‰
        ğŸ‰
      ğŸ‰
      ğŸ”¡ app font ğŸ”¡ ğŸ” cookies 10 990 10 ğŸ”·âš–â¡ï¸ ğŸ”·ğŸ¨ğŸ†• 0 0 0 255
      ğŸ¦ app

      ğŸŠ ğŸ˜› ğŸ” cookies 0 ğŸ‡
        ğŸš¿ app ğŸ”·ğŸ¨ğŸ†• 4 115 187 255
        ğŸ”¡ app font ğŸ”¤Well done!ğŸ”¤ 500 500 ğŸ”·âš–â†” ğŸ”·ğŸ¨ğŸ†• 255 255 255 255
        ğŸ¦ app

        ğŸ¦ endSample ğŸš‡ğŸ”·ğŸ¶ğŸ“„ ğŸ”¤sound_end.wavğŸ”¤
        ğŸ endSample 1 0 1

        ğŸ” ğŸ‘ ğŸ‡
          ğŸ¦ event â³ queue
          ğŸŠğŸ¦ keyboardEvent ğŸ”² event ğŸ“© ğŸ‡
            ğŸŠ ğŸ¦ key ğŸ”£ keyboardEvent ğŸ‡
              ğŸŠ ğŸ˜› key ğŸ”Ÿq ğŸ‡
                ğŸ âš¡ï¸
              ğŸ‰
            ğŸ‰
          ğŸ‰
        ğŸ‰
        ğŸ âš¡ï¸
      ğŸ‰

      ğŸ¦ event â³ queue

      ğŸŠğŸ¦ keyboardEvent ğŸ”² event ğŸ“© ğŸ‡
        ğŸŠ ğŸ˜›ğŸ“Ÿ keyboardEvent 84 ğŸ‡
          â¬†ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 85 ğŸ‡
          â¬‡ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 82 ğŸ‡
          â¬…ï¸ monster
        ğŸ‰
        ğŸ‹ ğŸ˜›ğŸ“Ÿ keyboardEvent 83 ğŸ‡
          â¡ï¸ monster
        ğŸ‰
      ğŸ‰
    ğŸ‰
  ğŸ‰
ğŸ‰
</code></pre><p>Well done! We have got a fully-fledge game!</p><div class="book-navigation-bottom"><a href="input-methods.html" class="left">â† Previous </a><a href="packageAPI.html" class="right">Next â†’</a></div><div class="book-improve">Want to improve this page? <a href="https://github.com/emojicode/emojicode.github.io/blob/master/src&#x2F;guides&#x2F;allegro.md" target="_blank">You can edit the source on GitHub and send us a pull request!</a></div></div><script src="/static/js/gumshoe.min.js"></script><script>gumshoe.init({ activeClass: 'current', offset: 80 });</script><script>!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);loadCSS('http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/xcode.min.css');</script></body></html>